# Техническое задание (TZ) - Run Risk Advisor

## 1) Цель проекта
- Разработать веб-сервис для планирования пробежек и оценки риска тренировки
- Система помогает выбрать более безопасное время и условия для бега, учитывая погоду и качество воздуха (PM2.5)
- Для каждой запланированной пробежки сервис автоматически формирует рекомендацию и сохраняет её в историю

## 2) Целевая аудитория
- Бегуны, которые хотят тренироваться безопаснее и осознаннее
- Пользователи с астмой, аллергией и повышенной чувствительностью дыхательных путей
- Люди, живущие в городах со скачками качества воздуха

## 3) Роли пользователей
- Гость
  - просмотр главной страницы и страницы "О проекте"
  - переход на страницу входа
- Авторизованный пользователь
  - настройка профиля (город, чувствительность, лимит PM2.5)
  - создание плана пробежки (дата/время, длительность, интенсивность)
  - просмотр истории рекомендаций и графика риска
- Администратор
  - управление городами
  - управление профилями пользователей
  - просмотр планов пробежек и рекомендаций в админ-панели

## 4) Модели данных (сущности)

### City
- name - название города
- latitude, longitude - координаты
- is_active - активен/не активен

Связи
- City 1 -> N UserProfile

### UserProfile
- user - связь OneToOne с пользователем Django
- city - выбранный город (ForeignKey -> City)
- sensitivity_level - уровень чувствительности (low/medium/high)
- pm25_limit - допустимый лимит PM2.5

Связи
- UserProfile 1 -> N RunPlan

### RunPlan
- profile - профиль пользователя (ForeignKey -> UserProfile)
- planned_start - дата и время пробежки
- duration_min - длительность (мин)
- intensity - интенсивность (low/medium/high)
- created_at - дата создания

Связи
- RunPlan 1 -> 1 Recommendation

### Recommendation
- run_plan - связь OneToOne с планом пробежки
- risk_score - числовой риск 0-100
- risk_level - уровень риска (low/medium/high)
- explanation - текст рекомендации
- created_at - дата создания

## 5) Ключевой функционал (User Stories)
- Пользователь регистрируется/входит в аккаунт и получает доступ к функционалу
- Пользователь открывает профиль и задаёт город, чувствительность и допустимый порог PM2.5
- Пользователь создаёт план пробежки (время, длительность, интенсивность)
- После сохранения плана система получает данные погоды и воздуха по городу из внешнего API
- Система рассчитывает риск пробежки (risk_score 0-100) и формирует текст рекомендации
- Результат сохраняется в БД и отображается в истории
- На странице истории строится график изменения риска

## 6) Внешние интеграции и аналитика
- Интеграция с OpenWeather API через библиотеку requests
  - получение погодных данных
  - получение данных качества воздуха (PM2.5)
- Аналитика
  - расчёт итогового risk_score на основе факторов (интенсивность, длительность, погода, PM2.5, чувствительность)
  - визуализация истории риска графиком через Plotly

## 7) Интерфейс и формы
- Используются Django Forms / ModelForms
- Реализована серверная валидация форм
- Используются шаблоны Django с наследованием base.html
- UI оформлен с использованием Bootstrap и собственной стилизации
- Реализованы переключатели темы (dark/light) и языка (ru/en)

## 8) Deploy
- Проект развёрнут в сети Интернет на Render.com
- Для production используется gunicorn и сбор статики collectstatic
- Настройки берутся из переменных окружения (.env локально, Environment Variables на Render)

